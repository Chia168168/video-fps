<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>計算影片 FPS</title>
</head>
<body>
    <video id="video" width="640" height="360" controls>
        <source src="your-video.mp4" type="video/mp4">
        您的瀏覽器不支援 video 標籤。
    </video>
    <p>FPS: <span id="fps">0</span></p>

    <script>
        const video = document.getElementById('video');
        const fpsDisplay = document.getElementById('fps');
        let frameCount = 0;
        let startTime = null;

        video.addEventListener('play', () => {
            // 重置計數
            frameCount = 0;
            startTime = performance.now();

            // 使用 requestAnimationFrame 計算 FPS
            function calculateFPS(timestamp) {
                if (!startTime) startTime = timestamp;
                
                frameCount++;
                const elapsedTime = (timestamp - startTime) / 1000; // 轉為秒

                if (elapsedTime >= 1) { // 每秒更新一次 FPS
                    const fps = Math.round(frameCount / elapsedTime);
                    fpsDisplay.textContent = fps;
                    // 重置計數
                    frameCount = 0;
                    startTime = timestamp;
                }

                if (!video.paused && !video.ended) {
                    requestAnimationFrame(calculateFPS);
                }
            }

            requestAnimationFrame(calculateFPS);
        });

        // 當影片暫停或結束時，停止計算
        video.addEventListener('pause', () => {
            fpsDisplay.textContent = '0';
        });
        video.addEventListener('ended', () => {
            fpsDisplay.textContent = '0';
        });
    </script>
</body>
</html>
