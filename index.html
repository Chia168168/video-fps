<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <title>å½±ç‰‡ FPS èˆ‡ç¸½å¹€æ•¸æª¢æ¸¬</title>
    <style>
      body { font-family:"Noto Sans TC",sans-serif;background:#f6f6f9;margin:0;padding:20px;text-align:center;color:#222; }
      h1 { margin-top:0;font-size:22px; }
      input[type=file]{margin:20px auto;display:block;}
      video{max-width:90%;border-radius:8px;background:#000;margin-top:20px;}
      #info{background:#fff;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.05);max-width:600px;margin:20px auto;padding:16px;text-align:left;}
      #info p{margin:6px 0;font-size:15px;}
    </style>
  </head>
  <body>
    <h1>ğŸ¬ å½±ç‰‡ FPS / Frame æ•¸ æª¢æ¸¬</h1>
    <input type="file" id="fileinput" accept="video/*">
    <div id="info">è«‹é¸æ“‡å½±ç‰‡æª”æ¡ˆ</div>
    <video id="video" controls playsinline></video>

    <!-- ä½¿ç”¨å®˜æ–¹ CDNï¼Œå…§å« mediainfo.min.js + wasm -->
    <script src="https://cdn.jsdelivr.net/npm/mediainfo.js/dist/mediainfo.min.js"></script>
    <script>
      const input = document.getElementById('fileinput');
      const info = document.getElementById('info');
      const video = document.getElementById('video');

      async function analyze(file){
        info.textContent = 'åˆ†æä¸­...';
        const mediainfo = await MediaInfo({ format: 'object' });
        const result = await mediainfo.analyzeData(() => file.size, chunkSize => file.slice(0, chunkSize));
        const vtrack = result.media.track.find(t => t['@type'] === 'Video');
        if (!vtrack) {
          info.innerHTML = 'ç„¡æ³•è®€å–å½±ç‰‡è³‡è¨Š';
          return;
        }
        const fps = vtrack.FrameRate || 'æœªçŸ¥';
        const frames = vtrack.FrameCount || 'æœªçŸ¥';
        const dur = vtrack.Duration ? (vtrack.Duration/1000).toFixed(2)+' ç§’' : 'æœªçŸ¥';
        const size = vtrack.Width && vtrack.Height ? `${vtrack.Width}Ã—${vtrack.Height}` : 'æœªçŸ¥';
        const fmt = vtrack.Format || 'æœªçŸ¥';
        info.innerHTML = `
          <p>ğŸ <b>FPSï¼š</b>${fps}</p>
          <p>ğŸ§® <b>ç¸½å¹€æ•¸ï¼š</b>${frames}</p>
          <p>â± <b>é•·åº¦ï¼š</b>${dur}</p>
          <p>ğŸ“ <b>è§£æåº¦ï¼š</b>${size}</p>
          <p>ğŸ’¾ <b>ç·¨ç¢¼æ ¼å¼ï¼š</b>${fmt}</p>
        `;
      }

      input.addEventListener('change', async e => {
        const file = e.target.files[0];
        if (!file) return;
        const url = URL.createObjectURL(file);
        video.src = url;
        video.load();
        analyze(file);
      });
    </script>
  </body>
</html>
